<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etch a Sketch</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="button-container">
        <button class="draw-button">Draw</button>
        <button class="erase-button">Erase</button>
        <button class="reset-button">Erase All</button>
        <input type="range" min="1" max="64" value="16" class="slider" id="grid-size">
        <div class="grid-content">16 x 16</div>
        <input type="range" min="600" max="800" value="600" class="slider" id="canvas">
        <div class="size-content">600 x 600</div>
    </div>
    <div class="grid-container"></div>

    <script>
        //default
        let gridWidth = 16;
        let gridHeight = 16;
        let screenSize = 600;
        let newBlock;

        let mouseDown = false;
            document.body.addEventListener('mousedown',() => (mouseDown = true));
            document.body.addEventListener('mouseup',() => (mouseDown = false));

        var sliderCanvas = document.getElementById("canvas");
        sliderCanvas.oninput = function() {
            screenSize = this.value;
            changeScreenSize(screenSize);
        }
        var sliderGridSize = document.getElementById("grid-size");
        sliderGridSize.oninput = function() {
            gridWidth = this.value;
            changeGrid();
        }

        const gridContainer = document.querySelector('.grid-container');
        const resetButton = document.querySelector('.reset-button');
              resetButton.addEventListener('click',reset);
        const screenSizeContent = document.querySelector('.size-content');
        const gridSizeContent = document.querySelector('.grid-content');

        let drawOrErase = true;
        const drawMode = document.querySelector('.draw-button');
              drawMode.addEventListener('click', () => {drawOrErase = true});
        const eraseMode = document.querySelector('.erase-button');
              eraseMode.addEventListener('click', () => {drawOrErase = false});

        function createGrid(){
            for (let i = 0; i < gridHeight * gridWidth; i++){
                newBlock = document.createElement('div');
                newBlock.classList.add('block');
                newBlock.style.setProperty('--BoxWidth', screenSize / gridWidth+'px');
                gridContainer.appendChild(newBlock);
            }
            gridContainer.style.setProperty('--ScreenSize', (screenSize)+'px');
            newBlock = document.querySelectorAll('.block');
            newBlock.forEach(a => a.addEventListener('mousedown', draw));
            newBlock.forEach(a => a.addEventListener('mouseover', draw));
        }

        createGrid();

        function draw (e){
            if(e.type == 'mouseover' && !mouseDown)return;
            drawOrErase ? this.style.setProperty('background', 'black') 
                        : this.style.setProperty('background', 'darkgray');
        }
        function reset (){
            newBlock.forEach(a => a.style.setProperty('background-color', 'darkgray'));
        }
        function changeScreenSize(size){
            screenSizeContent.textContent = size+' x '+size;
            newBlock.forEach(a => a.style.setProperty('--BoxWidth', size / gridWidth+'px'));
            gridContainer.style.setProperty('--ScreenSize', (size)+'px');
        }
        function changeGrid (){
            gridSizeContent.textContent = gridWidth+' x '+gridWidth;
            newBlock.forEach(block => block.remove());
            gridHeight = gridWidth; createGrid();
            changeScreenSize(screenSize);
            drawOrErase = true; //activate draw mode again
        }

    </script>
</body>
</html>